<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Onboarding - Gabriela Fiona</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
</head>

<!-- Add a scoped body class so header layout changes only affect Step 1 -->
<body class="step1">

<!-- FLOATING INVOICE WIDGET (shared) -->
<div id="floating-widget" class="collapsed">
    <div class="fw-header" onclick="toggleWidget()">
        <span>ESTIMATED TOTAL</span>
        <span id="fw-header-total">$0</span>
    </div>

    <!-- Removed fw-goal display from widget on Step 1 -->

    <div class="fw-content">
        <div id="fw-items">
            <p style="font-size:0.8rem; color:#666; font-style:italic;">Items added will appear here...</p>
        </div>
        <div class="fw-total">
            <span>Total</span>
            <span id="fw-full-total">$0</span>
        </div>
        <div class="fw-deposit">
            50% Deposit: <span id="fw-deposit">$0</span>
        </div>
    </div>
</div>

<!-- PROGRESS BAR -->
<div class="progress-header">
    <div class="progress-bar">
        <div class="progress-line-bg"></div>
        <div class="progress-line-fill" id="progress-fill" style="width:0%;"></div>

        <div class="step-indicator active" id="step-ind-1">
            1 <div class="step-label">Business Goals</div>
        </div>
        <div class="step-indicator" id="step-ind-2">
            2 <div class="step-label">Build Structure</div>
        </div>
        <div class="step-indicator" id="step-ind-3">
            3 <div class="step-label">Action Plan</div>
        </div>
        <div class="step-indicator" id="step-ind-4">
            4 <div class="step-label">Finalize Plan</div>
        </div>
    </div>

    <!-- NEW: header goals shown under progress bar -->
    <div id="header-goals" class="header-goals" style="display:none;">
        <div class="header-goals-title">Selected Goals</div>
        <div class="header-goals-chips">
            <span id="header-goal-website" class="goal-chip" style="display:none;"></span>
            <span id="header-goal-business" class="goal-chip" style="display:none;"></span>
        </div>
    </div>
</div>

<div class="container">
    <div id="step-1" class="step-section active">

        <div class="welcome-grid">
            <div class="welcome-text">
                <h1>Welcome.</h1>
                <p>We’re going to build your roadmap together. My goal for this call is to get clear on your vision and create a plan that feels simple, strategic, and completely "you."</p>
                <p>No jargon, no confusion—just a clear path forward.</p>
            </div>
            <div class="timeline">
                <div class="timeline-item">
                    <h4>1. The Business Context</h4>
                    <p>Understanding where you are now and where you want to go.</p>
                </div>
                <div class="timeline-item">
                    <h4>2. Scope &amp; Strategy</h4>
                    <p>Selecting the exact features and support you need.</p>
                </div>
                <div class="timeline-item">
                    <h4>3. The Plan</h4>
                    <p>Reviewing the investment and timeline to get us started.</p>
                </div>
            </div>
        </div>

        <hr style="border:0; border-top:1px solid var(--border); margin:40px 0;" />

        <div class="intake-section">
            <div style="margin-bottom:30px;">
                <h2>Client Essentials</h2>
                <p style="font-size:0.9rem; color:var(--text-light); opacity:0.7;">*I've saved your progress automatically. You can fill this out before the call.*</p>
            </div>

            <div class="intake-card">
                <div class="form-grid">
                    <div>
                        <label>Client Name</label>
                        <input type="text" id="clientName" class="save-me" placeholder="Jane Doe">
                    </div>
                    <div>
                        <label>Business / Brand Name</label>
                        <input type="text" id="businessName" class="save-me" placeholder="Studio LLC">
                    </div>
                    <div>
                        <label>Email Address</label>
                        <input type="email" id="clientEmail" class="save-me" placeholder="jane@studio.com">
                    </div>
                    <div>
                        <label>Phone Number</label>
                        <input type="tel" id="clientPhone" class="save-me" placeholder="(555) 123-4567">
                    </div>
                    <div>
                        <label>Current Website URL (If applicable)</label>
                        <input type="text" id="clientUrl" class="save-me" placeholder="www.currentsite.com">
                    </div>
                    <div>
                        <label>Industry</label>
                        <input type="text" id="clientIndustry" class="save-me" placeholder="e.g. Interior Design">
                    </div>
                </div>
            </div>

            <hr style="border:0; border-top:1px solid var(--border); margin:50px 0 40px;" />

            <div style="margin-bottom:30px;">
                <h2>Business Goals</h2>
                <p style="font-size:0.9rem; color:var(--text-light); opacity:0.7;">*This helps me recommend the right website structure and systems.*</p>
            </div>

            <div class="intake-card">
                <div class="form-grid">
                    <div class="full-width">
                        <label>Website Goal</label>
                        <select id="websiteGoal" class="save-me goal-tracker">
                            <option value="" disabled selected>Select one...</option>
                            <option value="Simple Online Presence">Simple Online Presence</option>
                            <option value="Website Upgrade">Website Upgrade</option>
                            <option value="Full Business Website">Full Business Website</option>
                        </select>
                    </div>
                    <div class="full-width">
                        <label>Website Goal Notes (Optional)</label>
                        <textarea id="websiteGoalNotes" rows="3" class="save-me" placeholder="Anything you want me to know about this website goal?"></textarea>
                    </div>

                    <div class="full-width">
                        <label>Business Goal</label>
                        <select id="businessGoal" class="save-me goal-tracker">
                            <option value="" disabled selected>Select one...</option>
                            <option value="Lead Generation">Lead Generation</option>
                            <option value="Brand Awareness">Brand Awareness</option>
                            <option value="Business Function(s)">Business Function(s)</option>
                        </select>
                    </div>
                    <div class="full-width">
                        <label>Business Goal Notes (Optional)</label>
                        <textarea id="businessGoalNotes" rows="3" class="save-me" placeholder="Any details about what success looks like for you?"></textarea>
                    </div>
                </div>
            </div>

            <hr style="border:0; border-top:1px solid var(--border); margin:50px 0 40px;" />

            <div style="margin-bottom:30px;">
                <h2>Systems Add-ons or Integrations</h2>
                <p style="font-size:0.9rem; color:var(--text-light); opacity:0.7;">*Select all that apply.*</p>
            </div>

            <div class="intake-card">
                <div class="addons-list systems-pill-list" id="systemsAddons">
                    <label class="addon-pill system-pill">
                        <input type="checkbox" value="Booking">
                        <span class="addon-name">Booking</span>
                    </label>

                    <label class="addon-pill system-pill">
                        <input type="checkbox" value="Scheduling">
                        <span class="addon-name">Scheduling</span>
                    </label>

                    <label class="addon-pill system-pill">
                        <input type="checkbox" value="Inventory">
                        <span class="addon-name">Inventory</span>
                    </label>

                    <label class="addon-pill system-pill">
                        <input type="checkbox" value="CRM">
                        <span class="addon-name">CRM</span>
                    </label>
                </div>

                <div style="margin-top:18px;">
                    <label>Systems Add-ons Notes (Optional)</label>
                    <textarea id="systemsAddonsNotes" rows="3" class="save-me" placeholder="Anything specific you want integrated (tools, preferences, or requirements)?"></textarea>
                </div>
            </div>

            <div class="step-nav-buttons" style="justify-content:flex-end;">
                <button class="btn btn-secondary" type="button" onclick="resetForm()">Reset Form</button>
                <button class="btn btn-primary" type="button" onclick="nextStep(2)">Next: Build Structure &rarr;</button>
            </div>
        </div>

    </div>
</div>

<script src="script.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const inputs = document.querySelectorAll('.save-me');
    inputs.forEach(input => {
        const saved = localStorage.getItem(input.id);
        if (saved !== null) input.value = saved;

        input.addEventListener('input', function () {
            localStorage.setItem(this.id, this.value);
            if (this.classList.contains('goal-tracker')) updateGoalTracker();
        });

        input.addEventListener('change', function () {
            localStorage.setItem(this.id, this.value);
            if (this.classList.contains('goal-tracker')) updateGoalTracker();
        });
    });

    initSystemsAddons();
    updateGoalTracker();

    // Load shared onboarding state for the widget totals
    if (window.loadState) window.loadState();
    if (window.calculateTotal) window.calculateTotal();
});

function updateGoalTracker() {
    const websiteGoalEl = document.getElementById('websiteGoal');
    const businessGoalEl = document.getElementById('businessGoal');

    const websiteGoal = websiteGoalEl ? websiteGoalEl.value : '';
    const businessGoal = businessGoalEl ? businessGoalEl.value : '';

    // Header goals (under progress bar)
    const headerWrap = document.getElementById('header-goals');
    const chipWebsite = document.getElementById('header-goal-website');
    const chipBusiness = document.getElementById('header-goal-business');

    const any = !!(websiteGoal || businessGoal);
    if (headerWrap) headerWrap.style.display = any ? 'flex' : 'none';

    if (chipWebsite) {
        if (websiteGoal) {
            chipWebsite.textContent = 'Website Goal: ' + websiteGoal;
            chipWebsite.style.display = 'inline-flex';
        } else {
            chipWebsite.style.display = 'none';
        }
    }

    if (chipBusiness) {
        if (businessGoal) {
            chipBusiness.textContent = 'Business Goal: ' + businessGoal;
            chipBusiness.style.display = 'inline-flex';
        } else {
            chipBusiness.style.display = 'none';
        }
    }
}

function initSystemsAddons() {
    const container = document.getElementById('systemsAddons');
    if (!container) return;

    const checkboxes = Array.from(container.querySelectorAll('input[type="checkbox"]'));
    if (!checkboxes.length) return;

    const syncSelectedClasses = () => {
        checkboxes.forEach(cb => {
            const pill = cb.closest('.system-pill');
            if (pill) pill.classList.toggle('selected', cb.checked);
        });
    };

    try {
        const saved = localStorage.getItem('systemsAddons');
        if (saved) {
            const values = JSON.parse(saved);
            if (Array.isArray(values)) {
                checkboxes.forEach(cb => cb.checked = values.includes(cb.value));
            }
        }
    } catch (e) {
        console.warn('Could not restore systemsAddons:', e);
    }

    syncSelectedClasses();

    const save = () => {
        const selected = checkboxes.filter(cb => cb.checked).map(cb => cb.value);
        localStorage.setItem('systemsAddons', JSON.stringify(selected));
        syncSelectedClasses();
    };

    checkboxes.forEach(cb => cb.addEventListener('change', save));
}

function resetForm() {
    if (confirm('Are you sure you want to clear all client data and selections?')) {
        localStorage.removeItem('clientName');
        localStorage.removeItem('businessName');
        localStorage.removeItem('clientEmail');
        localStorage.removeItem('clientPhone');
        localStorage.removeItem('clientUrl');
        localStorage.removeItem('clientIndustry');
        localStorage.removeItem('websiteGoal');
        localStorage.removeItem('websiteGoalNotes');
        localStorage.removeItem('businessGoal');
        localStorage.removeItem('businessGoalNotes');
        localStorage.removeItem('systemsAddons');
        localStorage.removeItem('systemsAddonsNotes');
        localStorage.removeItem('onboardingState');
        location.reload();
    }
}
</script>

</body>
</html>
